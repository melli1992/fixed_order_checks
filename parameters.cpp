#include <bits/stdc++.h>
#include <iostream> //for stirng
#include <fstream>
#include <sstream>
#include <unistd.h> //for getting options
#include <gsl/gsl_math.h>
#include <complex>
#include <gsl/gsl_complex.h>
#include <gsl/gsl_complex_math.h>
#include <stdlib.h> // for exit()
#include <getopt.h> //for getting options
#include <vector>
#include "LHAPDF/LHAPDF.h"

using namespace std;

//////////////////////////////////////////////////////////////////
///
/// parameters.cpp contains the functions to read in the parameters
/// that are used in the code and unchanged
/// contains stuff like invariant mass, com energy, tau, color
/// factors and the electromagnetic coupling constant
///
//////////////////////////////////////////////////////////////////


complex<double> I(0,1);
double CMP(2.5), phiMP(3./4.*M_PI);
double Q(500.);
double Q2(pow(Q,2.));
double S(13000.);
double S2(pow(S,2.));
double tau(Q2/S2);
double muF(Q);
double muR(Q);
double muF2(muF*muF);
double muR2(muR*muR);
double CF(4./3.);
double CA(3.);
double TF(1./2.);
double alphaEM(1./132.507);
double GF(1.166379e-5);
double alphas_muF(0);
double alphas_muR(0);
double alphas_Q(0);
double nF(5);
double b0((11*CA/3.-2*nF/3.)/(4.*M_PI)); 
double b1((17.*pow(CA,2)-10.*CA*TF*nF-6.*CF*TF*nF)/(24.*pow(M_PI,2)));
double beta0(4.*M_PI*b0);
double M_gammaE(0.57721566490153286060651209008240243104215933593992);
double zeta2(1.6449340668482264);
double zeta3(1.2020569031595942);
double zeta5(1.03692775514337);
double A1q(CF); // 1405.4827 eq. 12
double A1g(CA);// 1405.4827 eq. 12
double A2q(CF/2.*(CA*(67./18.-pow(M_PI,2)/6.)-10./9.*TF*nF));// 1405.4827 eq. 12
double A2g(CA/2.*(CA*(67./18.-pow(M_PI,2)/6.)-10./9.*TF*nF));// 1405.4827 eq. 12
double A3q(CF*((245./96.-67./216.*pow(M_PI,2)+11./720.*pow(M_PI,4)+11./24.*zeta3)*pow(CA,2)+(-209./432.+5./108.*pow(M_PI,2)-7./12.*zeta3)*CA*nF+(-55./96.+1./2.*zeta3)*CF*nF-1./108.*pow(nF,2)));// 1405.4827 eq. 12
double A3g(CA*((245./96.-67./216.*pow(M_PI,2)+11./720.*pow(M_PI,4)+11./24.*zeta3)*pow(CA,2)+(-209./432.+5./108.*pow(M_PI,2)-7./12.*zeta3)*CA*nF+(-55./96.+1./2.*zeta3)*CF*nF-1./108.*pow(nF,2)));// 1405.4827 eq. 12
double C2qgamma(pow(CF,2));  // 0807.4412 eq 35
double Dbar2q(3./4.*pow(CF,2)-11./12.*CA*CF+1./6.*nF*CF); // 0807.4412 eq 35
double B1q(-3./4*CF);
double B1g(-M_PI*b0);
double D1DY(0.);
double D2DY((-101./27.+11./3.*zeta2+7./2.*zeta3)*CA*CF+(14./27.-2./3.*zeta2)*nF*CF); //hep-ph/0508284 eq. 3.17
double D3DY(CF*pow(CA,2)*(-297029./23328.+6139./324.*zeta2-187./60*pow(zeta2,2)+2509./108.*zeta3-11./6.*zeta2*zeta3-6.*zeta5)
+ nf*CA*CF*(31313./11664.-1837./324.*zeta2+23./30.*pow(zeta2,2)-155./36.*zeta3)
+ nf*pow(CF,2)*(1711./864.-1./2.*zeta2+1./5.*pow(zeta2,2)-19./18.*zeta3)
+ pow(nf,2)*CF*(-58./729.+10./27.*zeta2+5./27.*zeta3)); //hep-ph/0508284 eq 4.7 

double D1higgs(0.);
double D2higgs((-101./27.+11./3.*zeta2+7./2.*zeta3)*CA*CA+(14./27.-2./3.*zeta2)*nF*CA); //hep-ph/0508265 eq. 36 (pulled out 1/16=1/4^2)
double D3higgs(pow(CA,3)*(-297029./23328.+6139./324.*zeta2-187./60*pow(zeta2,2)+2509./108.*zeta3-11./6.*zeta2*zeta3-6.*zeta5)
+ nf*pow(CA,2)*(31313./11664.-1837./324.*zeta2+23./30.*pow(zeta2,2)-155./36.*zeta3)
+ nf*CF*CA*(1711./864.-1./2.*zeta2+1./5.*pow(zeta2,2)-19./18.*zeta3)
+ pow(nf,2)*CA*(-58./729.+10./27.*zeta2+5./27.*zeta3)); //hep-ph/0508265 eq 35 (note that they pulled out a factor of 1/64=1/4^3)

double pbunits(0.38937966*pow(10.,9.));
string setname("PDF4LHC15_nnlo_100");
std::vector<LHAPDF::PDF*> pdfs;
double xmin_pdfs(0.), xmax_pdfs(0.); //min x, max x and alphas

/////////////////////////////////////////////////////////
///
/// data structure that contains the fit coefficients
/// where i_coeff is a vector of elements, the elements are
/// data is stored like: {Qvalue, {bbar_coeff,cbar_coeff, sbar_coeff, ubar_coeff, dbar_coeff, g_coeff, d_coeff, u_coeff, s_coeff, c_coeff, b_coeff}}
///
///////////////////////////////////////////////////////////
std::unordered_map<double, vector<vector<double>>> fitcoeff_PDF4LHC15_nnlo_100 = {
	{5000,{{1.30695963058,4.08134802242,-0.295564158148,0.748764156793,-0.251128425621,-2.2924481909,5.08149209904,-0.256995688622},{-79.1371469536,6.48718104722,-0.280377410439,0.800876675499,-0.199430325045,126.474615971,7.4870705917,-0.280982519299},{-0.765435535073,3.74064322617,-0.201654785044,0.104023244497,0.0471789377551,0.609198499527,3.64179292013,-0.323653966826},{0.630365041014,7.71126660153,-0.34576116014,0.223712886082,-0.671230292753,-2.19858768654,8.91626509595,-0.0197970223456},{0.195321079164,8.73139110933,-0.335907084111,3.31525207906,-2.15801998559,-1.38911536749,10.9222687781,-0.0923576906739},{10.477160062,7.72435958131,-0.390384504569,0.325776843348,-0.750525130405,-38.3356495839,8.92504091358,-0.0894781284154},{-0.923457376323,3.70827201735,-0.20328033048,-0.103364108786,0.277399428676,0.747755108447,3.43544280733,-0.313625554032},{0.38628756924,4.19918148521,-0.0742102067328,-1.94168092924,-1.3893148732,0.317852909342,14.3297952373,-0.353116499976},{-0.0576032529797,4.19237891892,-0.663878703836,1.05431545081,-2.05489745046,0.468969190693,5.79010277831,-0.332950512233},{0.903978301978,6.70107937026,-0.304091017377,0.716588979443,-0.254041629336,-1.61281635699,7.71761235476,-0.248174781064},{-146.570012879,9.14686505079,-0.278096339282,0.802422896931,-0.199957378284,234.55074699,10.1487312353,-0.278435810341}}},
	{2500,{{-218.96952342,4.37701709516,-0.270850784274,0.800279547435,-0.199726423281,350.176897024,5.37703238913,-0.271065768819},{0.906101632555,6.74898921411,-0.294828131544,0.716779636705,-0.248632365998,-1.60435113635,7.76692788576,-0.240584105987},{-72.9542419152,8.46077979845,-0.760205630703,-0.999235069134,-0.000765107343217,145.989613324,8.46168939872,-0.260786313155},{0.662844769136,7.76819255492,-0.335258978863,0.135834437306,-0.606289931259,-2.16908623623,8.90499166471,-0.00902174559824},{0.177405655482,8.93325239172,-0.326392539518,3.78199063441,-2.42840108914,-1.40191344446,11.278078114,-0.0781792138685},{10.2968073756,7.50163201257,-0.378525602228,0.330083238094,-0.729351675898,-36.7950356446,8.69226268598,-0.0825147005469},{-0.771324725811,3.66615988493,-0.179665282812,-0.130270571637,0.342761497888,0.608859185984,3.34608334772,-0.312022564873},{0.401499814146,4.11046901838,-0.0617228711535,-1.86250153919,-1.38869814528,0.32149599684,14.6302403064,-0.34227596418},{-0.0592587854805,4.06094992523,-0.649881914617,0.983459586549,-1.98480490195,0.466386906015,5.63294943959,-0.322368530524},{0.931889780422,6.7579032323,-0.294064271949,0.718871453538,-0.247335055551,-1.64573262079,7.77540335315,-0.241259608817},{2.04473068493,4.44157396182,-0.280435766481,0.768951289078,-0.230688180482,-3.45793567372,5.44104302645,-0.256783875473}}},
	{2000,{{2.59313897851,4.49755661497,-0.275200237088,0.776028339009,-0.223626825686,-4.33028403961,5.49701533641,-0.256837508236},{0.0138577566982,8.35179884601,-0.661411633362,-8.9990668662,7.99160108976,0.348768205014,10.6006850239,-0.341726288567},{-0.60722034567,3.77946041161,-0.155570046544,0.120818702173,0.0714192709591,0.436841537463,3.61747153716,-0.324967728845},{0.727224905965,7.99850324269,-0.332256252876,0.0119973585307,-0.532651494398,-2.21844795562,9.04492089041,-0.0018387435393},{-0.288261127193,4.70672537968,-0.137894880526,1.30738921539,0.359785231862,0.424246948378,7.81344357021,-0.325253396484},{10.234811621,7.42837123886,-0.374441402235,0.33158055178,-0.722027071613,-36.2746958487,8.61565025448,-0.0801102208643},{-0.731751569376,3.65186178505,-0.171633120571,-0.139861140962,0.365384122436,0.573572457394,3.31675240977,-0.311229480744},{0.403534512289,4.0759293691,-0.057539457305,-1.84168404153,-1.40372787963,0.323153200855,14.7360609508,-0.338463152765},{-0.0597711971796,4.02054961393,-0.645111351715,0.96442149283,-1.96608402625,0.466074952578,5.58537605237,-0.318640966076},{0.940569412919,6.77005070636,-0.290696822884,0.719895026794,-0.245183902196,-1.65570379612,7.78813254859,-0.238917159211},{2.70280203285,4.51424731272,-0.274817300593,0.776967956311,-0.222681840319,-4.50564081378,5.51368338226,-0.257192023025}}},
	{1500,{{4.76851921652,4.57593423008,-0.267415479844,0.787308871992,-0.212445317804,-7.80397802051,5.57551527386,-0.25763310891},{0.934058995096,6.77223347185,-0.286799847353,0.720151768151,-0.243045604405,-1.63954842408,7.7913715474,-0.235536268857},{-80.4881144213,9.75983444316,-0.752835444859,-0.999327143449,-0.000673052152271,161.059312882,9.76018327016,-0.253353742176},{0.114200112661,8.80839725048,-0.654033864467,-2.7998925056,1.80117999027,0.627349895487,11.9494945245,-0.296646664678},{0.840441394227,6.35714542127,-0.331129485031,-0.409955595422,-0.18583033063,-1.48256772525,6.48094414036,-0.0322345519042},{10.1474425419,7.3310947829,-0.368970263979,0.33381198645,-0.712153359269,-35.5673622877,8.51398639696,-0.0769298301885},{-0.685995159529,3.63252506975,-0.160986123933,-0.152965602458,0.395725406787,0.533393352524,3.27831534447,-0.309977706845},{0.399195812977,4.01853429172,-0.0517779197329,-1.8209418339,-1.45861882512,0.325343263884,14.8758412089,-0.333357238076},{-0.0604245361902,3.97003344833,-0.638761218403,0.94270223137,-1.94483973045,0.466184286792,5.52658193197,-0.313563378316},{0.969114890332,6.77958849307,-0.285870931549,0.722932954364,-0.241530189746,-1.69573083279,7.79814287925,-0.236415991789},{5.22553443623,4.58957690007,-0.26697007415,0.788400976506,-0.211364217044,-8.53509614436,5.58916956214,-0.258038779102}}},
	{1000,{{-9.2562717504,4.63398844498,-0.254838879699,0.806274098938,-0.193893880165,14.6458722776,5.6343081677,-0.259724192651},{0.964225034131,6.7785455005,-0.279991260559,0.724088878892,-0.238295399855,-1.67975952299,7.79892299611,-0.231574531263},{-0.547753932577,3.81256285614,-0.117996151417,0.126005401091,0.0915421508518,0.363566882211,3.59432916621,-0.323139509329},{0.116322725934,8.74241748233,-0.645310383048,-2.80277768531,1.80442924481,0.642071353069,11.8786867364,-0.287629215824},{-0.289309514124,5.57420864116,-0.113816984671,1.09762562645,0.43594208587,0.389719522402,8.53215903807,-0.31840952525},{10.0189292485,7.19157269186,-0.36082319011,0.33717725024,-0.697560265697,-34.5436179748,8.36825516989,-0.0721378838643},{-0.628952420173,3.6041313524,-0.145259307245,-0.173331590807,0.441657511231,0.484415214406,3.22304507301,-0.30781919074},{0.370125342316,3.89257503508,-0.0420711891186,-1.80092372669,-1.66868003336,0.326433791629,15.0482616062,-0.326217961485},{-0.0613443068107,3.90174216066,-0.62940252157,0.917227932471,-1.9201883559,0.467426723725,5.44854832295,-0.305832294225},{1.00852788338,6.78487344587,-0.278930368233,0.72739514585,-0.236658643705,-1.75075522146,7.80451857039,-0.23260225204},{-7.75670594571,4.6451116596,-0.254327258168,0.807500779624,-0.192706948389,12.2466435346,5.64551159694,-0.260161076579}}},
	{750,{{-2.69765046277,4.66164079223,-0.245036424589,0.820884192169,-0.179790810975,4.15930388751,5.66300762514,-0.261418978278},{0.996792493451,6.77632690466,-0.274805400588,0.72799385695,-0.234558296262,-1.72575982244,7.79754638537,-0.228951994076},{-0.29883496022,3.06313632065,-0.0753749309923,1.19735282669,0.0752423102425,0.310177863605,4.49621899023,-0.326749104696},{0.11839645672,8.70036268777,-0.638745175278,-2.80271778683,1.80467135919,0.654853726904,11.8357184422,-0.28069150856},{1.25549158664,6.36610751913,-0.326757891116,-0.625974248616,-0.133924786768,-2.30571807522,6.43161528662,0.0362251246291},{9.92304362452,7.09068014792,-0.354705157776,0.339774281109,-0.686719754054,-33.7964046757,8.26299042761,-0.068491076766},{-0.592836883127,3.58302390773,-0.13356260908,-0.189360810038,0.476813512295,0.454210598034,3.18292977711,-0.305983275571},{0.351128101508,3.80123754671,-0.0347829514182,-1.77845940996,-1.8267229494,0.326637277945,15.1429915532,-0.321016411836},{-0.0620169190294,3.85547850313,-0.622457251152,0.902784788814,-1.90646167239,0.469302803072,5.39689611451,-0.299875441356},{1.05894035618,6.78147185072,-0.273490462322,0.732257116755,-0.232550173984,-1.82517906123,7.80160352161,-0.230311616941},{-2.53696542486,4.67052672139,-0.244457800043,0.822252633637,-0.178487511132,3.90226636329,5.67204159932,-0.26189289242}}},
	{500,{{-1.2456100538,4.68897263286,-0.229793671739,0.843277587332,-0.158485801005,1.84621999137,5.692834127,-0.264099460625},{1.07402386079,6.76416560887,-0.266830011363,0.73563877183,-0.22857129335,-1.83997495695,7.78614109524,-0.225759159066},{0.251585742709,12.3621799749,-0.600174552326,-1.90306193949,0.904531006276,0.448216886868,16.6952673976,-0.293261776161},{1.41876010925,32.6996356528,-0.354479783283,-1.26371464848,0.397091748733,0.295343418204,9.06751475566,0.301948007994},{1.91020817555,6.35433712404,-0.323191939068,-0.756509180523,-0.0948132333114,-3.60943551453,6.39431343751,0.0825836279415},{-373.902422772,8.6481851032,-0.26428614758,0.843956145272,-0.204448010232,605.584363446,9.68471399425,-0.267290887874},{-0.546996119389,3.55165636983,-0.116292539393,-0.214583377237,0.530501004597,0.41704018547,3.12499332697,-0.302909501662},{0.334811915649,3.68827641672,-0.0247779747314,-1.73701373992,-1.99955578114,0.32830002086,15.2749119505,-0.312984968907},{-0.264407097187,2.95067243312,-0.0196211485701,1.45796491562,0.438374097732,0.272578776387,6.05118501114,-0.326817166142},{-0.0588000833014,5.39090752094,-0.618912875714,0.0885724491421,-1.08512810665,0.262670725013,6.40491840769,-0.335258374673},{-1.20691640506,4.69563014588,-0.229141056364,0.844776860091,-0.15708987512,1.78431928442,5.69975832033,-0.264587956825}}},
	{400,{{-0.927265541133,4.68834648258,-0.220528378079,0.856699908332,-0.14586973813,1.34240228729,5.69426122397,-0.265746409517},{1.17006141303,6.75153909354,-0.261669511872,0.742488434375,-0.224287212205,-1.98779453672,7.77293577669,-0.22485140903},{-0.506415610369,3.86176714758,-0.0629011842017,0.125359867762,0.121181400205,0.299244720222,3.55633262604,-0.317516745669},{0.125025855471,8.62249360957,-0.623119676257,-2.79874165817,1.80151415283,0.693025380441,11.764497822,-0.263545452638},{-0.381141399308,9.00739967728,0.000600181108888,-0.275245120568,1.44442705515,0.277656425854,18.2222030627,-0.321139095589},{9.70524380862,6.86925597984,-0.340238627026,0.345522998703,-0.661708220666,-32.1360761122,8.03237624604,-0.0595086079464},{-0.52384251375,3.53353199575,-0.106360256212,-0.230035944489,0.56248620332,0.398862882046,3.09233101914,-0.300958225577},{0.329034013631,3.6311231029,-0.0193998819981,-1.71299498142,-2.0773636411,0.330110299095,15.3528291864,-0.308147542281},{-0.0636478841659,3.7614421481,-0.606312240196,0.881810617231,-1.88756163015,0.477362111159,5.29614858995,-0.28518774612},{1.33468093198,6.75354677948,-0.259498344547,0.7497398688,-0.221276819416,-2.25089141888,7.77244453584,-0.227240883133},{-0.905258877502,4.69427020383,-0.219845723151,0.858241211174,-0.144453124339,1.30716673085,5.70052907002,-0.266226161339}}},
	{300,{{-0.676334085893,4.66540842313,-0.207523611714,0.875214867192,-0.128602750142,0.947894707509,5.67489862817,-0.268010338212},{-56.2275912349,6.31532204596,-0.742532023479,-0.999523385956,-0.000476767161609,112.445728646,6.3153548977,-0.243087405196},{-0.499239214303,3.87853111137,-0.0439320128373,0.123738861624,0.131329845258,0.283552183084,3.54234243564,-0.315029018952},{0.129547942185,8.59858952897,-0.615234239886,-2.79216474963,1.79539506518,0.716461003518,11.7494780857,-0.254624355497},{5.86464497808,6.34025160198,-0.317513715578,-0.919709685649,-0.0349212702226,-11.5010452262,6.3525267507,0.148420728104},{9.5974803574,6.7653271951,-0.333043654709,0.348326075576,-0.649513468395,-31.3457743522,7.92438817536,-0.0548990315326},{-0.495182103517,3.50969297608,-0.0929325072005,-0.252329573699,0.607533188846,0.37697982958,3.04935100067,-0.298227284468},{0.32356718708,3.56071949271,-0.0126011901971,-1.68406735603,-2.16666583088,0.33359836189,15.4606302102,-0.301403446999},{-0.0645143067212,3.72217278637,-0.598432272813,0.877427657222,-1.88442686411,0.483436845184,5.25652384125,-0.277543832409},{2.10918273762,6.6664916538,-0.257531594486,-0.0453417623504,-0.00182364758818,-2.18474145422,6.67728136445,-0.22739539274},{-0.66463951985,4.67086595849,-0.206813403871,0.876785369138,-0.127183596309,0.929112651404,5.68081272452,-0.268464712033}}},
	{200,{{-0.475217956562,4.64489434519,-0.187752427451,0.902172238614,-0.103878930054,0.63572324132,5.66133858426,-0.270770938514},{1.71837090873,6.70017557369,-0.253560550027,-0.052702816748,-0.000543137670992,-1.78611315729,6.71392388676,-0.218216943306},{-2.72925680365,3.37667566354,-0.321016987787,-1.11497205507,0.0327828533148,5.75239482173,3.36477969644,0.239834601519},{0.137094415937,8.56996123032,-0.603207648695,-2.78724758704,1.7912449766,0.758159471816,11.7344415432,-0.240677006134},{-11.5065903592,6.32845093933,-0.312001949569,-1.04231664573,0.0202095420389,23.2675734817,6.322276358,0.207756983297},{9.44677248285,6.61974880313,-0.322207002627,0.351907008156,-0.63209554006,-30.2604328814,7.77372067278,-0.0474841177402},{-0.457729707861,3.47400059415,-0.0730051781943,-0.288453734424,0.678068592302,0.349687729239,2.98686654178,-0.293766080093},{0.31802897548,3.46567392954,-0.00331370036548,-1.65381035837,-2.2821948077,0.341336898711,15.6244959635,-0.290758715782},{-0.0659605502616,3.67153921758,-0.586736725763,0.87705674081,-1.88621966353,0.495563472408,5.20873215394,-0.265549492438},{1.60898201503,6.70509123046,-0.254386411812,-0.0572720012906,-0.000533764014824,-1.67748174433,6.71943836922,-0.216329032736},{-118.362128279,5.20418874809,-0.235280204593,0.00075901980629,0.000157970439733,118.26933288,5.20409980573,-0.235766477728}}},
	{150,{{-79.9198979602,5.10115613227,-0.22939873527,0.00109249288934,0.000213439219634,79.8319269937,5.10104949277,-0.230093530346},{1.23893236552,6.71092063498,-0.254095132977,-0.071607485592,0.00117450974111,-1.30165038832,6.72945146271,-0.206287112022},{0.2699627988,12.1329493166,-0.562626647229,-1.87602479485,0.87942984254,0.456253152587,16.4971007374,-0.261605383945},{0.143819107753,8.55724748136,-0.593870722114,-2.78401294025,1.78865524287,0.795440764641,11.7340924504,-0.229651877192},{-4.21916226324,6.32723528676,-0.307463995839,-1.11985107453,0.0612221599686,8.72326358851,6.31059966464,0.253173341136},{9.33838630978,6.51695221653,-0.313990498737,0.353976397804,-0.619648134774,-29.5082908432,7.66789019789,-0.0414336541795},{-0.43243678239,3.4472499051,-0.0580229766012,-0.31855541067,0.734826779941,0.332227652138,2.94097664878,-0.290180294752},{0.314770293274,3.40033612767,0.00303307160839,-1.64482384902,-2.36380976016,0.349402544899,15.7469853562,-0.282257137142},{-0.0672283641173,3.63967785135,-0.577976255572,0.881193233744,-1.89223430052,0.507570213309,5.18159526223,-0.255997578142},{1.07156345355,6.71147412911,-0.257145021998,-0.0852077594706,0.00143870846636,-1.13591267101,6.73209295798,-0.200940797535},{-0.379515997315,4.62575300584,-0.171553184589,0.924173527524,-0.0840290327562,0.489131420151,5.64975382939,-0.272954850098}}},
	{125,{{2.18524329985,5.04275550921,-0.237127619414,-0.0411387066221,-0.00717718154357,-2.27349234214,5.04574500621,-0.211665967745},{0.869149009742,6.70462334457,-0.259142890946,-0.102691826194,0.00340443326095,-0.930389104393,6.7299423244,-0.191011186815},{0.274784797521,12.108244084,-0.556317473384,-1.87200240779,0.875849924794,0.461234150264,16.4873258344,-0.255426186988},{0.148927897293,8.5544985009,-0.58753898068,-2.78131861596,1.78641585588,0.823352108814,11.7410127619,-0.222094580555},{-3.1831769265,6.32818648859,-0.304297891436,-1.16388353432,0.0874164878213,6.6774636048,6.30630167245,0.283390287762},{9.26952876054,6.45169908158,-0.308518475603,0.355038491218,-0.611760281448,-29.0424932577,7.60099005642,-0.0371891348953},{-0.416794745388,3.4296503756,-0.048123892042,-0.340057660284,0.774372380841,0.321870916179,2.91116991183,-0.287710394213},{0.312653191321,3.35992782755,0.00689856055514,-1.64820992617,-2.41883734908,0.356116320915,15.8254052513,-0.276353188801},{-0.0681661338279,3.62159383726,-0.572193235617,0.885911784421,-1.89831059813,0.517005388245,5.16780331811,-0.249423969351},{0.744811771348,6.69939050583,-0.263854696364,-0.125043497963,0.00390939734759,-0.809150944516,6.72763255055,-0.182009332561},{2.84231100276,5.05072515051,-0.23438865151,-0.0313627581464,-0.00556680443528,-2.92997824231,5.05309396495,-0.214903630529}}},
	{100,{{-2.10648562187,5.03030215138,-0.20916377956,0.037976267422,0.00736750191169,2.02715089186,5.02678469602,-0.233685264158},{0.614052596045,6.68379905354,-0.26604858785,-0.148145089722,0.00736035797986,-0.675151811002,6.71789630741,-0.168310311335},{0.281678524339,12.0827213554,-0.54836255229,-1.8670332009,0.871474211684,0.469038161593,16.4855691146,-0.247277073314},{0.156003434817,8.55476792208,-0.579315601963,-2.77891457127,1.78462505927,0.862537572826,11.7539141612,-0.212218235412},{0.767134344007,13.259491535,-0.543608991965,-1.57087976326,0.572937294236,0.565835129494,20.3260359421,-0.233080546845},{9.18678537722,6.37216697645,-0.301537906938,0.35586136052,-0.602365888694,-28.4999995069,7.51991689603,-0.0314245679506},{-0.398123858523,3.40719984381,-0.0356000874113,-0.369217848938,0.826888920373,0.310000287514,2.87383239821,-0.28443945142},{0.990691490284,4.18595798447,-0.0117061042944,-1.56158120792,-0.351501761022,0.38503726675,14.7760841388,-0.266240571151},{-0.0694648259156,3.60128692501,-0.564857559821,0.893560175651,-1.9077831832,0.530523017446,5.15396499923,-0.240829312042},{0.565354337659,6.67646042628,-0.269552180477,-0.168354463962,0.00775801150786,-0.62994813598,6.71184324078,-0.159947492048},{-1.8766343395,5.03653229741,-0.207531937547,0.0425900782077,0.00834723368569,1.79725211226,5.03249814493,-0.235074140634}}},
	{75,{{0.391717696954,4.90008162455,-0.284392421386,-0.367840365443,-0.0384978046896,-0.529662395593,4.90858030055,-0.0829601656708},{0.464627544431,6.64875710292,-0.271725433594,-0.199426696268,0.0136668096742,-0.525572915232,6.69164788098,-0.140355402864},{0.29263378566,12.0588953622,-0.53763040805,-1.86186805206,0.867212031449,0.483993769358,16.4975827478,-0.235368819454},{0.167168535908,8.56647432958,-0.567737334415,-2.7761176132,1.78274073754,0.924446732404,11.7847070704,-0.198194330102},{0.802441248932,13.2101887463,-0.532536949308,-1.57205483703,0.574503180122,0.597154359856,20.3033430515,-0.219472551565},{9.07998830901,6.26903178019,-0.292019752381,0.356047212384,-0.590555587035,-27.8328196804,7.41547360756,-0.0229902406661},{-0.374163731146,3.3771088666,-0.0186109213164,-0.413073281451,0.903726444333,0.295564189274,2.82420800588,-0.279862396419},{-3.30230637436,8.94244138989,-0.154191415281,-0.694689543986,0.233002394219,1.55203301405,3.94260887429,-0.208470113588},{-0.0715976072254,3.5804532697,-0.554866537214,0.90725113965,-1.92422617302,0.553329325917,5.1441335469,-0.22848032923},{0.445526331606,6.6400784016,-0.274300262588,-0.218579304816,0.0138371076966,-0.510464990269,6.68267041683,-0.132304474925},{-0.710090364273,4.9978004834,-0.179450693006,0.102536252631,0.0217012294829,0.637167495899,4.98625600638,-0.248187446935}}},
    {50,{{-0.391224084632,4.94001582949,-0.142381137978,0.165762173175,0.0378963299784,0.325676855299,4.91769437026,-0.258471353396},{0.354527219686,6.5883594798,-0.27641813005,-0.265719407865,0.0250220494098,-0.415008784832,6.6414517589,-0.100423032826},{0.312935601203,12.0450787027,-0.52144217216,-1.85738010274,0.864244659431,0.516734124944,16.5445297561,-0.21555713661},{0.186820734862,8.59597055108,-0.549226292055,-2.77944226954,1.78765848812,1.03853425873,11.8419231855,-0.175694950391},{-2.20626595668,6.3487778929,-0.284782602057,-1.31656831794,0.213318285561,5.02687047259,6.31792357324,0.455168062828},{-617.235821145,7.13914490602,-0.200894110234,0.81706913038,-0.201327029039,991.344752616,8.15204797919,-0.202632401661},{-0.340188317399,3.33200516235,0.00706574720314,-0.490849732527,1.03484364355,0.276751770214,2.75098680783,-0.272631395371},{-3.48020277034,8.81565561294,-0.142928103877,-0.695559148221,0.231398894432,1.64303972046,3.89581026766,-0.194714673069},{-0.0757264430123,3.56222645473,-0.539517560331,0.933480726965,-1.95510069608,0.59826232395,5.14632168946,-0.208350513495},{0.350083256985,6.57859876218,-0.278222148245,-0.285536358828,0.0247018355825,-0.415516787047,6.62942620393,-0.0921112378389},{-0.387529456659,4.94578811638,-0.141347526104,0.167824107822,0.0386289859373,0.32170350423,4.92286506018,-0.258911997294}}},
	{25,{{-0.0391691583498,4.3002375236,-0.564549723689,0.032565357586,-1.03825637999,0.175522972298,5.37079378843,-0.250420951142},{-0.220761133093,6.6905132274,-0.0427556676207,0.278446398427,-0.016287377033,0.176024630957,6.44791517677,-0.277652168539},{0.369834776517,12.1007921856,-0.488867580038,-1.86512716973,0.875510905149,0.633233960538,16.712145053,-0.169464232316},{0.125631479641,6.25807028062,-0.248644699463,0.233409030771,0.35539391032,0.0164713241862,273.290827026,-0.367478819576},{1.03518757094,13.1173414235,-0.478078485653,-1.59091258365,0.59578173747,0.852605457117,20.2398251086,-0.146345019665},{-259.677105871,6.67092665066,-0.171860397602,0.835645431628,-0.202984848462,418.823354016,7.69670630375,-0.175769106138},{-0.278573932565,3.24667782927,0.056685620225,-0.698894157968,1.36446868337,0.247655741477,2.61505832716,-0.257890525939},{-3.85971836271,8.59741582756,-0.120167503897,-0.699537985541,0.229761198026,1.82744651142,3.80705172342,-0.167897272031},{-0.0886245201838,3.57852787707,-0.507477962064,0.996650739461,-2.02914751326,0.737848486617,5.21136244003,-0.163229145842},{-0.220350997684,6.67472336681,-0.0362863377241,0.288240211368,-0.0115528735731,0.172966635696,6.42880538533,-0.278594437123},{-0.0393651716524,4.30578422946,-0.564525864018,0.0325951277902,-1.03833495013,0.176446037555,5.37645121248,-0.249995518585}}},
	{10,{{-0.0274539590109,3.95809032763,-0.491645205188,0.0154016569893,-1.04657445754,0.123374450957,5.02142770185,-0.178025146783},{0.0276935292556,4.16146617744,-0.284567249035,1.26490852158,0.891801724868,0.298961313667,7.15215093395,1.54539523538},{0.517746701658,12.3241459053,-0.421494671503,-1.91327923545,0.933048827596,1.01217152796,16.9891161812,-0.0742997477952},{0.156539760541,6.20346261725,-0.174721414634,0.213515949274,0.359768041068,0.0187075722444,240.83275827,-0.362697144436},{0.981629682853,11.8897901552,-0.175992672293,-1.10222108474,0.378785773942,0.00752406422032,410.603624572,-0.427371644349},{1.76386860576,5.54030902659,-0.26468332955,0.00270811154618,0.492140148605,0.636851972018,383.07437694,-0.121801449509},{-0.175759452222,3.11639504651,0.138654191769,-1.43917400111,2.43877407976,0.211115535499,2.40617772398,-0.233308792204},{1.96468906965,27.862918636,-0.224672635105,-1.2335054892,0.348586958203,4.4636283692,4.03541049236,0.702706281548},{-0.13160695091,3.73488357585,-0.438661012309,1.09424627856,-2.15524933303,1.19478626613,5.44633547899,-0.0692136400854},{0.0272815359419,4.13565246591,-0.284256677348,1.29630231423,0.919028779811,0.280553799435,7.01147079786,1.48380968777},{-0.0276477823418,3.9621832321,-0.491617487272,0.0156489022733,-1.04674838238,0.12431701689,5.02604371016,-0.177392819643}}}
};

// declaration of the structure that is going to be used - default fitcoeff_PDF4LHC15_nnlo_100
std::unordered_map<double, vector<vector<double>>> fitcoeff = fitcoeff_PDF4LHC15_nnlo_100;


///////////////////////////////////////
/// usage of the read argument function
///////////////////////////////////////
void print_usage() {
  cout << endl
       << "Usage:" << endl
       << " -p   <set>     specify PDFs being used (default \"PDF4LHC15_nnlo_100\")" << endl
       << "                installed: NNPDF31_nnlo_as_0118, CT14nnlo, PDF4LHC15_nnlo_100" << endl
       << "                           NNPDF31_nlo_as_0118, CT14nlo, PDF4LHC15_nlo_100 " << endl
	   << "							  MSTW2008nnlo90cl, MMHT2014nlo68cl, GRVPI0" << endl
       << " -Q   <Q>      set transferred momentum Q [GeV]" << endl
       << " -r   <muR>         set renormalization scale [GeV]" << endl
       << " -f   <muF>         set factorization scale [GeV]" << endl
       << " -S   <com> 	    set C.O.M. energy [TeV]" << endl
       << endl;
  exit(0);
  return;
}

///////////////////////////////////////
/// defaults of the programm
///////////////////////////////////////
void update_defaults(){
    Q2 = pow(Q,2);
    muF2 = muF*muF;
    muR2 = muR*muR;
    tau = Q2/S2;
    LHAPDF::PDFSet setk(setname);
	int nmem(0.); //number of members
	vector<int> pids; //number of flavors, span from -5 to 5 with 0 = 21 gluon
	nmem = setk.size()-1;
	pdfs = setk.mkPDFs();
	pids = pdfs[0]->flavors();
	xmin_pdfs = pdfs[0]->xMin();
	xmax_pdfs = pdfs[0]->xMax();
	alphas_muF = pdfs[0]->alphasQ(muF);
	alphas_Q = pdfs[0]->alphasQ(Q);
	alphas_muR = pdfs[0]->alphasQ(muR);
cout << "The values are set as follows: " << endl
	<< "PDFset: 				" << setname << endl
	<< "Momentum [GeV]: 			" << Q << endl
	<< "Renormalization scale [GeV]: 		" << muR << endl
	<< "Factorization scale [GeV]:		" << muF << endl
	<< "Center of Mass energy [TeV]: 		" << S/1000. << endl
	<< "tau:					" << tau << endl;
	cout << "alphas_Q:			 	" << alphas_Q << endl;
	cout << "alphas_muF:		 		" << alphas_muF << endl;
	cout << "alphas_muR: 		 		" << alphas_muR << endl;
}


///////////////////////////////////////
/// read arguments of command line
///////////////////////////////////////

void read_arguments(int argc, char* argv[]) {
  const char* const short_options = "hp:f:r:Q:S:"; //: is needed as there is a variable after the -p, -S etc
  int next_option;
  ostringstream sset;
  while ((next_option = getopt(argc, argv, short_options)) != -1)
  { switch (next_option) {
    case 'h':
      print_usage();
    case 'p':
      sset << optarg;
      setname = sset.str();
      if (setname=="PDF4LHC15_nnlo_100"){fitcoeff = fitcoeff_PDF4LHC15_nnlo_100;}
      break;
    case 'f':
      muF = strtod(optarg, NULL);
      muF2 = muF*muF;
      break;
    case 'r':
      muR = strtod(optarg, NULL);
      muR2 = muR*muR;
      break;
    case 'Q':
      Q = strtod(optarg, NULL);
      muF = Q;
      muR = Q;
      break;
    case 'S':
       S = strtod(optarg, NULL)*1000.;
       S2 = pow(S,2);
      break;
    case -1: break;
    case ':': abort();
    }
  }
  tau = Q2/S2; //reset tau
  return;
}
